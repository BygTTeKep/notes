# Кэширование

## Инвалидация кэша

Инвалидация кэша - это процесс удаления или обновления устаревших данных
в кэше чтобы обеспечить их актуальность и соответсвие реальным данным.

### Методы инвалидации

1. Явная инвалидация - когда приложение намерено удаляет данные из кэша
2. Инвалидация по TTL(time to live) - кэш удаляется после истечения его времени жизни
3. Инвалидация по событию - когда происходит обновление данных кэш обновляется
4. Ленивая инвалидация - кэш остается нетронутым, пока данные не будут запрошены.
   При обнаружении устаревших данных кэш обновляется на месте.
5. Глобальная инвалидация - удаляются все данные из кэша. Применяется в случаях
   значительных изменений в приложении.(команда flushall в redis)

Шторм инвалидации - это явление при котором большое количество данных удаляется из
кэша одновременно
Для предотвращения может использоваться случайное значение **jitter** которое
добавляется к ttl.

## Кэширование ошибок

Ситуация - клиент запрашивает данные которых нет в источнике. Если таких запросов
могут возникнуть проблемы с производительностью бд.
Специальные атаки(cache miss atack) суть - запрашивать данные которых точно нет
в кэше.
Для предотвращения можно завести отдельный кэш под эти ошибки

## Стратегии вытеснения

Размер кэша ограничен и мы не можем запихать все данные в кэш, но что если
память под кэш закончилась, а новые запписи продолжают поступать.

1. Ничего не делать(плохо)
2. Random - стратегия при которой удаляются рандомные данные из кэша
3. TTL - удаление той записи которой осталось меньше жить.
4. LRU(Least Recently Used) - стратегия вытеснения которая опирается на время
   последнего использования записи
5. LFU(Least Frequently Used) - Стратегия опирающаяся на частоту использования.
   Удаляются записи которые использовались реже всего.
